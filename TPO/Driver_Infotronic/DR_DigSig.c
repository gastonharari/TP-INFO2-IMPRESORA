
/*******************************************************************************************************************************//**
 *
 * @file		Template.c
 * @brief		Breve descripción del objetivo del Módulo
 * @date		Fecha de creacion del archivo XX/XX/XXXX
 * @author		Nombre, Apellido
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/

#include "DR_DigSig.h"

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/
uint8_t bufferEntrada;


/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/
 
 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/
/**
 \fn  int main(void)
 \brief funcion principal
 \param void
 \return void
 */
void debounce (void)
{
	static uint8_t ContadorEntradas[ENTRADAS] = {0};
	uint8_t in = 0, x;
	uint8_t i;

	in = GetPIN(key0, ALTO);

	if ( GetPIN(key1, ALTO) )
		in |= 0x02;

	if ( GetPIN(key2, ALTO) )
		in |= 0x04;

	if ( GetPIN(key3, ALTO) )
		in |= 0x08;

	x = in ^ bufferEntrada;

	if ( !x )
	{
		for ( i=0 ; i < ENTRADAS ; i++ )
			ContadorEntradas[i] = 0;
	}
	else
	{
		for ( i=0 ; i<ENTRADAS ; i++ )
		{
			if ( x & (1<<i) )
			{
				ContadorEntradas[i]++;
				if ( ContadorEntradas[i] >= Rebotes )
				{
						bufferEntrada = bufferEntrada ^ (1<<i);
				}

			}
			else
			{
				ContadorEntradas[i] = 0;
			}
		}
	}
}

